---
import { Star, Quote } from "lucide-react";

import { siteContent } from "../data/siteContent";

const marqueeReviews = [
    ...siteContent.reviews.items,
    ...siteContent.reviews.items,
];
---

<section id="opinions" class="py-16 md:py-24 bg-brand-surface overflow-hidden">
    <div class="max-w-7xl mx-auto px-6 md:px-12 mb-12 md:mb-16">
        <div
            class="flex flex-col md:flex-row gap-8 items-end justify-between border-b border-brand-black/10 pb-8"
        >
            <div>
                <span
                    class="text-brand-light-green font-semibold tracking-widest uppercase text-xs mb-4 block"
                    >{siteContent.reviews.badge}</span
                >
                <h2
                    class="font-serif text-3xl md:text-5xl font-bold mb-4 text-brand-black"
                >
                    {siteContent.reviews.title}
                </h2>
                <p class="text-brand-black/60 text-lg max-w-xl font-light">
                    {siteContent.reviews.description}
                </p>
            </div>

            <div
                class="bg-brand-white px-8 py-4 border border-brand-stone flex items-center gap-6 shadow-sm shrink-0"
            >
                <div class="text-4xl font-bold font-serif text-brand-black">
                    {siteContent.reviews.googleRating.value}
                </div>
                <div class="flex flex-col">
                    <div class="flex text-brand-green mb-1 gap-1">
                        <Star className="w-4 h-4 fill-current" />
                        <Star className="w-4 h-4 fill-current" />
                        <Star className="w-4 h-4 fill-current" />
                        <Star className="w-4 h-4 fill-current" />
                        <div class="relative">
                            <Star
                                className="w-4 h-4 text-brand-green/30 fill-current"
                            />
                            <div
                                class="absolute inset-0 overflow-hidden w-[40%]"
                            >
                                <Star className="w-4 h-4 fill-current" />
                            </div>
                        </div>
                    </div>
                    <span
                        class="text-xs text-brand-black/60 font-medium uppercase tracking-wider"
                        >{siteContent.reviews.googleRating.label}</span
                    >
                </div>
            </div>
        </div>
    </div>

    <div class="relative w-full">
        <div
            class="absolute left-0 top-0 bottom-0 w-12 md:w-40 bg-gradient-to-r from-brand-surface to-transparent z-10 pointer-events-none"
        >
        </div>
        <div
            class="absolute right-0 top-0 bottom-0 w-12 md:w-40 bg-gradient-to-l from-brand-surface to-transparent z-10 pointer-events-none"
        >
        </div>

        <div class="flex animate-scroll hover:pause gap-6 md:gap-8 w-max pl-6">
            {
                marqueeReviews.map((review, index) => (
                    <div class="w-[85vw] md:w-[450px] shrink-0 bg-brand-white p-8 md:p-10 shadow-[0_2px_20px_-10px_rgba(0,0,0,0.05)] border border-brand-stone/50 flex flex-col justify-between h-full select-none transition-transform hover:scale-[1.01] duration-300">
                        <div class="mb-6">
                            <div class="flex justify-between items-start mb-6">
                                <div class="flex text-brand-green gap-1">
                                    {Array.from({ length: 5 }).map((_, i) => (
                                        <Star
                                            className={`w-3 h-3 ${i < review.stars ? "fill-current" : "text-brand-stone fill-current"}`}
                                        />
                                    ))}
                                </div>
                                <Quote className="w-8 h-8 text-brand-terra/20 fill-current" />
                            </div>
                            <p class="text-brand-black/80 font-serif text-lg leading-relaxed line-clamp-6">
                                "{review.text}"
                            </p>
                        </div>
                        <div class="flex items-center justify-between border-t border-brand-stone/50 pt-4">
                            <p class="font-bold text-brand-black text-sm uppercase tracking-wider">
                                {review.name}
                            </p>
                            <span class="text-[10px] font-bold text-brand-black/40 uppercase tracking-widest flex items-center gap-1">
                                {review.source}
                            </span>
                        </div>
                    </div>
                ))
            }
        </div>
    </div>
</section>

<style>
    @keyframes scroll {
        from {
            transform: translateX(0);
        }
        to {
            transform: translateX(-50%);
        }
    }

    .animate-scroll {
        animation: scroll 100s linear infinite;
    }

    .animate-scroll:hover {
        animation-play-state: paused;
    }
</style>
